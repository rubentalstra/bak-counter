<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Bets</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
</head>

<body>

    <%- include('partials/_navbar') %>

        <div class="container mt-5">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h1>Current Bets</h1>
                <a href="/bets/create" class="btn btn-primary">Create Bet</a>
            </div>

            <% bets.forEach(bet=> { %>
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">
                            <%= bet.Initiator.name %> vs. <%= bet.Opponent.name %>
                        </h5>
                        <h6 class="card-subtitle mb-2 text-muted">Judge: <%= bet.Judge.name %>
                        </h6>
                        <p class="card-text">Description: <%= bet.betDescription %>
                        </p>
                        <p class="card-text">Stake: <%= bet.stake %> REP points</p>
                        <% if (bet.status==='pending' ) { %>
                            <form action="/bets/judge/<%= bet.betId %>" method="POST" class="d-inline">
                                <input type="hidden" name="winnerUserId" value="<%= bet.Initiator.id %>">
                                <button type="submit" class="btn btn-success">Declare <%= bet.Initiator.name %> as
                                        Winner</button>
                            </form>
                            <form action="/bets/judge/<%= bet.betId %>" method="POST" class="d-inline">
                                <input type="hidden" name="winnerUserId" value="<%= bet.Opponent.id %>">
                                <button type="submit" class="btn btn-warning">Declare <%= bet.Opponent.name %> as
                                        Winner</button>
                            </form>
                            <% } else { %>
                                <p class="card-text"><strong>Winner:</strong>
                                    <%= bet.winnerUserId===bet.Initiator.id ? bet.Initiator.name : bet.Opponent.name %>
                                </p>
                                <% } %>
                    </div>
                </div>
                <% }) %>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>