<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weddenschappen Bekijken</title>
    <%- include('partials/_favicon') %>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
</head>

<body>

    <%- include('partials/_navbar') %>

    <div class="container mt-5">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h1>Weddenschappen</h1>
            <a href="/bets/create" class="btn btn-primary">Weddenschap Aanmaken</a>
        </div>

        <!-- Navigatietabs -->
        <ul class="nav nav-tabs" id="betTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="active-bets-tab" data-bs-toggle="tab" data-bs-target="#active-bets"
                    type="button" role="tab" aria-controls="active-bets" aria-selected="true">Actieve
                    Weddenschappen</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="closed-bets-tab" data-bs-toggle="tab" data-bs-target="#closed-bets"
                    type="button" role="tab" aria-controls="closed-bets" aria-selected="false">Gesloten
                    Weddenschappen</button>
            </li>
        </ul>

        <!-- Tabinhoud -->
        <div class="tab-content">
            <div class="tab-pane fade show active" id="active-bets" role="tabpanel" aria-labelledby="active-bets-tab">
                <% bets.filter(bet=> bet.status === 'pending').forEach(bet => { %>
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">
                            <%= bet.Initiator.name %> vs. <%= bet.Opponent.name %>
                        </h5>
                        <h6 class="card-subtitle mb-2 text-muted">Scheidsrechter: <%= bet.Judge.name %>
                        </h6>
                        <p class="card-text">Beschrijving: <%= bet.betDescription %>
                        </p>
                        <p class="card-text">Inzet: <%= bet.stake %> REP punten</p>
                        <% if (user.id === bet.judgeUserId && bet.status === 'pending') { %>
                        <form action="/bets/judge/<%= bet.betId %>" method="POST" class="d-inline">
                            <input type="hidden" name="winnerUserId" value="<%= bet.Initiator.id %>">
                            <button type="submit" class="btn btn-success">Verklaar <%= bet.Initiator.name %> als
                                Winnaar</button>
                        </form>
                        <form action="/bets/judge/<%= bet.betId %>" method="POST" class="d-inline">
                            <input type="hidden" name="winnerUserId" value="<%= bet.Opponent.id %>">
                            <button type="submit" class="btn btn-warning">Verklaar <%= bet.Opponent.name %> als
                                Winnaar</button>
                        </form>
                        <% } %>

                    </div>
                </div>
                <% }); %>
            </div>
            <div class="tab-pane fade" id="closed-bets" role="tabpanel" aria-labelledby="closed-bets-tab">
                <% bets.filter(bet=> bet.status !== 'pending').forEach(bet => { %>
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">
                            <%= bet.Initiator.name %> vs. <%= bet.Opponent.name %>
                        </h5>
                        <h6 class="card-subtitle mb-2 text-muted">Scheidsrechter: <%= bet.Judge.name %>
                        </h6>
                        <p class="card-text">Beschrijving: <%= bet.betDescription %>
                        </p>
                        <p class="card-text">Inzet: <%= bet.stake %> REP punten</p>
                        <p class="card-text"><strong>Winnaar:</strong>
                            <%= bet.winnerUserId===bet.Initiator.id ? bet.Initiator.name : bet.Opponent.name %>
                        </p>
                    </div>
                </div>
                <% }); %>
            </div>
        </div>


    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>